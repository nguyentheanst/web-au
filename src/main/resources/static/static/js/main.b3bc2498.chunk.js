(this.webpackJsonpuntitled=this.webpackJsonpuntitled||[]).push([[0],{37:function(e,t,n){},38:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n.n(s),i=n(30),c=n.n(i),r=(n(37),n(38),n(13)),o=n(2),l=n(16),u=n.n(l),d=n(31),p=n(11),j=n(10),h=n.n(j),O=function(e){return h.a.post("/api/assertion/start?username=".concat(e),null,{withCredentials:!0})},b=function(e){return h.a.post("/api/assertion/finish",e,{withCredentials:!0})},f=n(4),g=n.n(f),x=n(1),m=function(){var e=Object(s.useState)(""),t=Object(p.a)(e,2),n=t[0],a=t[1],i=Object(s.useState)({status:1,message:""}),c=Object(p.a)(i,2),r=c[0],o=c[1],l=function(){var e=Object(d.a)(u.a.mark((function e(){var t,s,a,i,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.PasswordCredential){e.next=4;break}o({status:1,message:"Browser Not Supported"}),e.next=31;break;case 4:return e.prev=4,e.next=7,O(n);case 7:return t=e.sent,s=t.data,console.log(s),(a=s).credentialOptions.challenge=g.a.toBuffer(a.credentialOptions.challenge),a.credentialOptions.allowCredentials&&(a.credentialOptions.allowCredentials=a.credentialOptions.allowCredentials.map((function(e){var t=Object.assign({},e);return t.id=g.a.toBuffer(t.id),t}))),e.next=15,navigator.credentials.get({publicKey:a.credentialOptions});case 15:return i=e.sent,(c={}).id=i.id,c.rawId=g.a.encode(i.rawId),c.type=i.type,i.getClientExtensionsResults?c.clientExtensionResults=i.getClientExtensionsResults():c.clientExtensionResults={},i.response&&(c.response={authenticatorData:g.a.encode(i.response.authenticatorData),clientDataJSON:g.a.encode(i.response.clientDataJSON),signature:g.a.encode(i.response.signature),userHandle:i.response.userHandle?g.a.encode(i.response.userHandle):null}),a.credential=c,e.next=25,b(a);case 25:o({status:0,message:"Authentication Successful"}),e.next=31;break;case 28:e.prev=28,e.t0=e.catch(4),o({message:e.t0.message,status:1});case 31:case"end":return e.stop()}}),e,null,[[4,28]])})));return function(){return e.apply(this,arguments)}}();return Object(x.jsxs)("div",{children:[Object(x.jsxs)("form",{children:[Object(x.jsx)("h3",{children:"Authentication"}),Object(x.jsxs)("div",{children:[Object(x.jsx)("label",{children:"Name"}),Object(x.jsx)("input",{value:n,type:"text",onChange:function(e){e.preventDefault(),a(e.target.value)}}),Object(x.jsx)("button",{onClick:function(e){e.preventDefault(),o({status:1,message:""}),l()},children:"Authenticate"})]})]}),Object(x.jsx)("div",{children:r.message})]})},v=function(){var e=Object(s.useState)({message:""}),t=Object(p.a)(e,2),n=t[0],a=t[1],i=Object(s.useState)(""),c=Object(p.a)(i,2),r=c[0],o=c[1],l=function(e){e.creationOptions.challenge=g.a.toBuffer(e.creationOptions.challenge),e.creationOptions.user.id=g.a.toBuffer(e.creationOptions.user.id),e.creationOptions.excludeCredentials&&(e.creationOptions.excludeCredentials=e.creationOptions.excludeCredentials.map((function(e){var t=Object.assign({},e);return t.id=g.a.toBuffer(t.id),t}))),navigator.credentials.create({publicKey:e.creationOptions}).then((function(t){var n,s={};if(s.id=t.id,s.rawId=g.a.encode(t.rawId),s.type=t.type,t.getClientExtensionsResults?s.clientExtensionResults=t.getClientExtensionsResults():s.clientExtensionResults={},t.response){var i=g.a.encode(t.response.clientDataJSON),c=g.a.encode(t.response.attestationObject);s.response={clientDataJSON:i,attestationObject:c}}e.credential=s,(n=e,h.a.post("/api/registration/finish",n,{withCredentials:!0,headers:{"Content-Type":"application/json"}})).then((function(){a({status:0,message:"Device successfully registered"})})).catch((function(e){a({status:1,message:e.message})}))})).catch((function(e){a({status:1,message:e.message})}))},u=function(){var e;window.PasswordCredential?(e=r,h.a.post("/api/registration/start?username=".concat(e),null,{withCredentials:!0})).then((function(e){l(e.data)})).catch((function(e){console.log(e),e.response&&e.response.data?a({status:1,message:"".concat(e.response.data.error)}):a({status:1,message:"".concat(e.message)})})):a({status:1,message:"Browser not supported"})};return Object(x.jsxs)("form",{className:"measure",children:[Object(x.jsx)("h3",{children:"Register"}),Object(x.jsxs)("div",{children:[Object(x.jsx)("label",{children:"Name "}),Object(x.jsx)("input",{value:r,type:"text",onChange:function(e){e.preventDefault(),o(e.target.value)}}),Object(x.jsx)("button",{onClick:function(e){e.preventDefault(),u()},children:"Register"})]},"ppp"),Object(x.jsxs)("div",{children:[" ",n.message]})]},"registration_authenticator_form")};var w=function(){return Object(x.jsxs)("div",{children:[Object(x.jsxs)("ul",{children:[Object(x.jsx)("li",{children:Object(x.jsx)(r.b,{to:"/",children:"Register"})}),Object(x.jsx)("li",{children:Object(x.jsx)(r.b,{to:"/auth",children:"Login"})})]}),Object(x.jsxs)(o.c,{children:[Object(x.jsx)(o.a,{path:"/auth",component:m}),Object(x.jsx)(o.a,{exact:!0,path:"/",component:v})]})]})};c.a.render(Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(r.a,{children:Object(x.jsx)(w,{})})}),document.getElementById("root"))}},[[68,1,2]]]);
//# sourceMappingURL=main.b3bc2498.chunk.js.map